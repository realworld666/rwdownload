<?php/* * Copyright (c) 2023. * RW::Software * Dave Conley * https://www.rwscripts.com/ */$loader = new browse();class browse{	function browse()	{		global $IN, $OUTPUT, $std;		if (isset($IN['rwdchk'])) {			$OUTPUT->add_output($std->showLicenceInformation());			return;		}		switch ($IN["ACT"]) {			case 'idx':				$this->main();				break;			case 'offline':				$this->isoffline();				break;		}	}	function main()	{		global $guser, $std, $OUTPUT, $CONFIG, $IN;		require_once ROOT_PATH . "/functions/category.php";		require_once ROOT_PATH . "/functions/files.php";		$cat = new Category();		$files = new Files();		if ($CONFIG['isoffline'])			$this->isoffline();		$IN['cid'] = intval($IN['cid']);		if ($IN['cid']) {			// If user has no browse permissions then skip this category			if (!$std->canAccess($IN["cid"], "canBrowse")) {				$std->error(GETLANG("er_noaccess"));				return;			}			$std->updateNav("", $IN["cid"]);			$numcats = $cat->listAll($IN["cid"]);			$numfiles = $files->listAll($IN["cid"]);			if (!$numfiles and $numcats == 0)				$std->warning(GETLANG("warn_nocatshere"));			else if ($numcats == -1 and !$numfiles)				$std->warning(GETLANG("nofiles"));		} else if ($IN['dlid']) {			$files->show($IN['dlid']);		} else {			$std->updateNav("", 0);			// Category root			$cat->listAll(0);		}		$OUTPUT->add_output($cat->output);		$OUTPUT->add_output($files->output);	}	function isoffline()	{		global $CONFIG, $OUTPUT, $std;		$std->updateNav(GETLANG("dcoffline"), 0);		$output = "<div class='offline'><b>" . GETLANG("dcoffline") . "</b><br><br>" . $CONFIG['offlinemsg'] . "</div>";		$OUTPUT->add_output($output);	}}?>